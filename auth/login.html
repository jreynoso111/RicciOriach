<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ingresar | Riccie Oriach</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="auth.css">
</head>
<body>
    <canvas id="canvas-bg"></canvas>
    <nav class="navbar">
        <div class="logo"><a href="../index.html">RICCIE ORIACH</a></div>
        <ul class="nav-links">
            <li><a href="../index.html">INICIO</a></li>
            <li><a href="../music.html">MÚSICA</a></li>
            <li><a href="../merch.html">MERCH</a></li>
            <li><a href="../events.html">TICKETS</a></li>
            <li><a href="../blog.html">BLOG</a></li>
            <li><a href="../contact.html">CONTACTO</a></li>
            <li><a href="../perfil.html">PERFIL</a></li>
            <li><a class="active" href="login.html">ACCESO</a></li>
        </ul>
    </nav>

    <section class="page">
        <div class="card">
            <p class="badge">Cuenta segura</p>
            <h1>Ingresa a tu cuenta</h1>
            <p class="subtitle">Vincula tu sesión antes de completar el checkout. Puedes usar Google o tu correo y contraseña.</p>
            <div class="actions" style="margin-top:1rem;">
                <button class="btn" id="google-login">Continuar con Google</button>
                <a class="btn secondary" href="register.html">Crear cuenta</a>
            </div>
        </div>
        <div class="cards">
            <div class="card">
                <h3>Login con correo</h3>
                <form id="login-form" class="form-grid">
                    <label>Correo electrónico<input type="email" id="login-email" required></label>
                    <label>Contraseña<input type="password" id="login-password" required></label>
                    <div class="actions">
                        <button class="btn" type="submit">Ingresar</button>
                        <a class="btn secondary" href="../perfil.html">Ir al perfil</a>
                    </div>
                </form>
            </div>
            <div class="card">
                <h3>Estado de sesión</h3>
                <p id="session-status" class="status">Sin sesión activa.</p>
                <div class="actions">
                    <button class="btn secondary" id="logout-btn">Cerrar sesión</button>
                    <a class="btn" href="../checkout.html">Pasar al checkout</a>
                </div>
            </div>
        </div>
    </section>

    <script src="auth.js"></script>
    <script>
        const statusEl = document.getElementById('session-status');
        const loginForm = document.getElementById('login-form');

        function refreshStatus() {
            const session = RicciAuth.getSession();
            if (session?.email) {
                statusEl.textContent = `Sesión iniciada como ${session.name || session.email} (${session.provider || 'correo'})`;
            } else {
                statusEl.textContent = 'Sin sesión activa.';
            }
        }

        document.getElementById('google-login').addEventListener('click', () => {
            RicciAuth.googleLogin();
            refreshStatus();
            alert('Sesión creada con Google (modo desarrollo).');
        });

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            try {
                RicciAuth.loginUser(document.getElementById('login-email').value.trim(), document.getElementById('login-password').value.trim());
                refreshStatus();
                alert('Sesión iniciada. Puedes continuar al checkout o perfil.');
            } catch (err) {
                alert(err.message || 'No se pudo iniciar sesión.');
            }
        });

        document.getElementById('logout-btn').addEventListener('click', () => {
            RicciAuth.logout();
            refreshStatus();
        });

        refreshStatus();
    </script>
    <script>
        const canvas = document.getElementById('canvas-bg');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight; let particlesArray = []; let speedMultiplier = 1; let scrollTimeout; const hues=[90,110,135,155,180,210];
        class Particle{constructor(){this.x=Math.random()*canvas.width;this.y=Math.random()*canvas.height;this.size=Math.random()*3+0.5;this.speedX=(Math.random()*2-1)*this.size*0.18;this.speedY=(Math.random()*2-1)*this.size*0.18;const hue=hues[Math.floor(Math.random()*hues.length)];const light=45+Math.random()*35;const alpha=0.18+Math.random()*0.32;this.color=`hsla(${hue},70%,${light}%,${alpha})`;}
            update(){this.x+=this.speedX*speedMultiplier;this.y+=this.speedY*speedMultiplier;if(this.x>canvas.width)this.x=0;else if(this.x<0)this.x=canvas.width;if(this.y>canvas.height)this.y=0;else if(this.y<0)this.y=canvas.height;}
            draw(){ctx.beginPath();ctx.arc(this.x,this.y,this.size,0,Math.PI*2);ctx.fillStyle=this.color;ctx.fill();}}
        function init(){particlesArray=[];const count=(canvas.width*canvas.height)/9000;for(let i=0;i<count;i++)particlesArray.push(new Particle());}
        function animate(){requestAnimationFrame(animate);ctx.clearRect(0,0,canvas.width,canvas.height);particlesArray.forEach(p=>{p.update();p.draw();});}
        window.addEventListener('resize',()=>{canvas.width=window.innerWidth;canvas.height=window.innerHeight;init();});
        window.addEventListener('wheel',()=>{speedMultiplier=3;clearTimeout(scrollTimeout);scrollTimeout=setTimeout(()=>speedMultiplier=1,250);});
        init(); animate();
    </script>
</body>
</html>
